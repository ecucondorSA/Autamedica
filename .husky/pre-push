#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ðŸš€ Validando antes de push (scope: auth + web-app deployment)..."

# Validar solo las apps que se van a desplegar
echo "ðŸ“‹ Lint auth app..."
cd apps/auth && pnpm lint || exit 1
cd ../..

echo "ðŸ“‹ Lint web-app..."
cd apps/web-app && pnpm lint || exit 1
cd ../..

echo "ðŸ“‹ TypeCheck packages y apps deployment..."
pnpm --filter @autamedica/types typecheck || exit 1
pnpm --filter @autamedica/shared typecheck || exit 1
pnpm --filter @autamedica/auth typecheck || exit 1
pnpm --filter @autamedica/auth-app typecheck || exit 1
pnpm --filter @autamedica/web-app typecheck || exit 1

echo "ðŸ“‹ Tests packages..."
pnpm --filter @autamedica/types test || exit 1
pnpm --filter @autamedica/shared test || exit 1

echo "âœ… QA OK (auth + web-app) â€“ Push permitido"