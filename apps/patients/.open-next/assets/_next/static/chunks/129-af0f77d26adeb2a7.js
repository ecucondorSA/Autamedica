"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[129],{5129:(e,t,r)=>{r.d(t,{fi:()=>s,XK:()=>T,DO:()=>l,n8:()=>I});var a,n,o=r(2613),i=r(4444),E=new Set(["NEXT_PUBLIC_API_URL","NEXT_PUBLIC_APP_URL","NEXT_PUBLIC_AUTH_HUB_URL","NEXT_PUBLIC_AUTH_HUB_DEV_URL","NEXT_PUBLIC_SITE_URL","NEXT_PUBLIC_DOCTORS_URL","NEXT_PUBLIC_DOCTORS_DEV_URL","NEXT_PUBLIC_PATIENTS_URL","NEXT_PUBLIC_PATIENTS_DEV_URL","NEXT_PUBLIC_COMPANIES_URL","NEXT_PUBLIC_SIGNALING_URL","NEXT_PUBLIC_AUTH_DEV_BYPASS","NEXT_PUBLIC_SUPABASE_URL","NEXT_PUBLIC_SUPABASE_ANON_KEY","NEXT_PUBLIC_SENTRY_DSN","NEXT_PUBLIC_RECAPTCHA_SITE_KEY","NEXT_PUBLIC_RECAPTCHA_SITE_KEY_WEB","NEXT_PUBLIC_RECAPTCHA_SITE_KEY_IOS","NEXT_PUBLIC_RECAPTCHA_SITE_KEY_ANDROID","NEXT_PUBLIC_GOOGLE_MAPS_API_KEY","NEXT_PUBLIC_MAPBOX_ACCESS_TOKEN","NEXT_PUBLIC_ICE_SERVERS","NEXT_PUBLIC_STUN_SERVER","NEXT_PUBLIC_WEBRTC_SIGNALING_URL","NEXT_PUBLIC_MEDIASOUP_URL","NEXT_PUBLIC_OPENAI_API_KEY","NEXT_PUBLIC_AI_PREDICTOR_ENABLED","NEXT_PUBLIC_PATIENT_CRYSTAL_BALL_ENABLED","NEXT_PUBLIC_DIGITAL_PRESCRIPTION_ENABLED","NEXT_PUBLIC_AI_ASSISTANT_ENABLED","NEXT_PUBLIC_MARKETPLACE_ENABLED","NEXT_PUBLIC_HOSPITAL_REDISTRIBUTION_ENABLED","NEXT_PUBLIC_WHATSAPP_BUSINESS_ENABLED","NEXT_PUBLIC_IOT_SENSORS_ENABLED","NEXT_PUBLIC_HOSPITAL_API_ENABLED","NEXT_PUBLIC_ADMIN_PANEL_ENABLED","NEXT_PUBLIC_PROMETHEUS_ENABLED","NEXT_PUBLIC_HIPAA_AUDIT_ENABLED","NEXT_PUBLIC_REQUIRE_AUTH","NEXT_PUBLIC_DATABASE_ADMIN_ENABLED","NEXT_PUBLIC_AUDIT_LOGS_ENABLED"]),_=new Set(["JWT_SECRET","JWT_REFRESH_SECRET","ENCRYPTION_KEY","SESSION_SECRET","NEXTAUTH_SECRET","SUPABASE_SERVICE_ROLE_KEY","DATABASE_URL","REDIS_URL","UPSTASH_REDIS_REST_TOKEN","OPENAI_API_KEY","ANTHROPIC_API_KEY","MERCADOPAGO_ACCESS_TOKEN","MERCADOPAGO_WEBHOOK_SECRET","MERCADOPAGO_TEST_ACCESS_TOKEN","TURN_PASSWORD","TURN_SECRET","SMTP_PASS","WHATSAPP_BUSINESS_TOKEN","WHATSAPP_WEBHOOK_VERIFY_TOKEN","RECAPTCHA_SECRET_KEY","SENTRY_AUTH_TOKEN"]);function c(e){if(!E.has(e))throw Error("Invalid client environment variable: ".concat(e,". Only approved NEXT_PUBLIC_* variables are allowed on client side."));if(_.has(e.replace("NEXT_PUBLIC_","")))throw Error("Security violation: ".concat(e," appears to be a server-only variable exposed to client"))}function s(e){c(e);let t=i.env[e];if(!t)throw Error("Missing required client environment variable: ".concat(e));return t}function T(e,t){c(e);let r=i.env[e];return null!=r?r:t}function l(e){var t;return c(e),null!=(t=i.env[e])?t:void 0}function I(e,t){if(e.startsWith("NEXT_PUBLIC_"))throw Error("Invalid server environment variable: ".concat(e,". Server-side code should not use NEXT_PUBLIC_ variables directly."));let r=i.env[e];return null!=r?r:t}new class{error(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];console.error("[ERROR] ".concat(e),...r)}warn(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];console.warn("[WARN] ".concat(e),...r)}info(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a]}debug(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a]}},new TextEncoder,new TextDecoder,(a=class extends Error{constructor(e,t){var r,a;super(e,t),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,null==(r=(a=Error).captureStackTrace)||r.call(a,this,this.constructor)}}).code="ERR_JOSE_GENERIC",(n=class{static async getUserMediaWithRetry(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={...this.DEFAULT_RETRY_CONFIG,...e};for(let e of this.FALLBACK_CONSTRAINTS)try{return await this.attemptGetUserMedia(e,t)}catch(t){console.warn("⚠️ getUserMedia fall\xf3 con constraints:",e,t);continue}throw Error("No se pudo acceder a c\xe1mara/micr\xf3fono con ninguna configuraci\xf3n")}static async attemptGetUserMedia(e,t){let r=null;for(let a=0;a<=t.maxRetries;a++)try{return await navigator.mediaDevices.getUserMedia(e)}catch(e){if(r=e,e instanceof DOMException&&("NotAllowedError"===e.name||"NotFoundError"===e.name))throw e;if(a<t.maxRetries){let e=Math.min(t.initialDelay*Math.pow(t.backoffMultiplier,a),t.maxDelay);await this.delay(e)}}throw r||Error("getUserMedia fall\xf3 despu\xe9s de todos los reintentos")}static setupICEConnectionMonitoring(e,t){let r=null,a=!1,n=()=>{let n=e.iceConnectionState;switch(r&&(clearTimeout(r),r=null),n){case"connected":case"completed":a=!1;break;case"disconnected":console.warn("⚠️ Conexi\xf3n WebRTC desconectada, esperando reconexi\xf3n..."),r=setTimeout(()=>{"disconnected"!==e.iceConnectionState||a||(a=!0,null==t||t())},5e3);break;case"failed":console.error("❌ Conexi\xf3n WebRTC fall\xf3"),a||(a=!0,null==t||t())}};return e.addEventListener("iceconnectionstatechange",n),()=>{e.removeEventListener("iceconnectionstatechange",n),r&&clearTimeout(r)}}static async getConnectionStats(e){let t=await e.getStats(),r=0,a=0,n=0,o=0;return t.forEach(e=>{"inbound-rtp"===e.type&&(r+=e.bytesReceived||0,n+=e.packetsReceived||0),"outbound-rtp"===e.type&&(a+=e.bytesSent||0,o+=e.packetsSent||0)}),{bytesReceived:r,bytesSent:a,packetsReceived:n,packetsSent:o,connectionState:e.connectionState,iceConnectionState:e.iceConnectionState,timestamp:Date.now()}}static async testICEServers(e){try{let t=new RTCPeerConnection({iceServers:e});return t.createDataChannel("test"),await t.createOffer(),new Promise(e=>{let r=!1;t.onicecandidate=a=>{a.candidate?r=!0:(t.close(),e(r))},setTimeout(()=>{t.close(),e(!1)},1e4)})}catch(e){return console.error("❌ Error testing ICE servers:",e),!1}}static createICEServers(){let e=[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302"]}],t=i.env.NEXT_PUBLIC_TURN_URLS,r=i.env.NEXT_PUBLIC_TURN_USERNAME,a=i.env.NEXT_PUBLIC_TURN_CREDENTIAL;return t&&r&&a&&e.push({urls:t.split(","),username:r,credential:a}),e}static diagnoseGetUserMediaError(e){if(e instanceof DOMException)switch(e.name){case"NotAllowedError":return"Permisos de c\xe1mara/micr\xf3fono denegados. Por favor, habilita los permisos en tu navegador.";case"NotFoundError":return"No se encontr\xf3 c\xe1mara o micr\xf3fono. Verifica que los dispositivos est\xe9n conectados.";case"NotReadableError":return"C\xe1mara o micr\xf3fono en uso por otra aplicaci\xf3n. Cierra otras apps que puedan estar us\xe1ndolos.";case"OverconstrainedError":return"La configuraci\xf3n solicitada no es compatible con tu dispositivo.";case"NotSupportedError":return"Tu navegador no soporta acceso a c\xe1mara/micr\xf3fono.";case"AbortError":return"Acceso a c\xe1mara/micr\xf3fono fue cancelado.";default:return"Error de c\xe1mara/micr\xf3fono: ".concat(e.message)}return"Error desconocido: ".concat(e.message)}static async diagnose(){return{devices:await navigator.mediaDevices.enumerateDevices(),permissions:{camera:await this.checkPermission("camera"),microphone:await this.checkPermission("microphone")},capabilities:{video:null,audio:null}}}static async checkPermission(e){try{return(await navigator.permissions.query({name:e})).state}catch(e){return"prompt"}}static delay(e){return new Promise(t=>setTimeout(t,e))}}).DEFAULT_RETRY_CONFIG={maxRetries:3,initialDelay:1e3,backoffMultiplier:2,maxDelay:1e4},n.FALLBACK_CONSTRAINTS=[{video:{width:{ideal:1280},height:{ideal:720},frameRate:{ideal:30},facingMode:"user"},audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}},{video:{width:{ideal:640},height:{ideal:480},frameRate:{ideal:24}},audio:{echoCancellation:!0}},{video:{width:{max:320},height:{max:240}},audio:!0},{video:!1,audio:!0}],(0,o.UU)("https://gtyvdircfhmdjiaelqkg.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd0eXZkaXJjZmhtZGppYWVscWtnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYyOTI3OTAsImV4cCI6MjA3MTg2ODc5MH0.7UFMVZsWTWOAynnhzkG76I_lhVCYtd_RmTt9EH3wJD4")}}]);