(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{3842:(e,a,r)=>{"use strict";r.d(a,{UU:()=>s});var t=r(3427);function s(){let e="https://gtyvdircfhmdjiaelqkg.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd0eXZkaXJjZmhtZGppYWVscWtnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2Njc4NTUsImV4cCI6MjA3MjI0Mzg1NX0.DeEm08k7QOrKObWaz8AUaOB5N6Z2QZhZHFaUf2siALA";return e&&a?(0,t.createBrowserClient)(e,a):(console.error("Supabase configuration error: Invalid URL or key"),(0,t.createBrowserClient)("https://gtyvdircfhmdjiaelqkg.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd0eXZkaXJjZmhtZGppYWVscWtnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYyOTI3OTAsImV4cCI6MjA3MTg2ODc5MH0.7UFMVZsWTWOAynnhzkG76I_lhVCYtd_RmTt9EH3wJD4"))}r(4444)},5637:(e,a,r)=>{Promise.resolve().then(r.bind(r,6272))},6272:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>l});var t=r(3919),s=r(1111),i=r(4336),c=r(3842);let o=[{value:"patient",label:"Paciente",description:"Accede a tu historial m\xe9dico, agenda citas y consulta con profesionales",icon:"\uD83C\uDFE5",color:"border-green-200 hover:border-green-400 hover:bg-green-50"},{value:"doctor",label:"M\xe9dico",description:"Gestiona pacientes, consultas y utiliza herramientas m\xe9dicas avanzadas",icon:"\uD83D\uDC69‍⚕️",color:"border-blue-200 hover:border-blue-400 hover:bg-blue-50"},{value:"company_admin",label:"Empresa",description:"Administra empleados, planes de salud y servicios corporativos",icon:"\uD83C\uDFE2",color:"border-purple-200 hover:border-purple-400 hover:bg-purple-50"},{value:"platform_admin",label:"Administrador",description:"Gestiona la plataforma completa y configuraciones avanzadas",icon:"⚙️",color:"border-gray-200 hover:border-gray-400 hover:bg-gray-50"}];function n(e){let{user:a}=e,[r,i]=(0,s.useState)(null),[c,n]=(0,s.useTransition)();return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Registrado como: ",(0,t.jsx)("span",{className:"font-semibold",children:a.email})]})}),(0,t.jsx)("div",{className:"space-y-3",children:o.map(e=>{let a=r===e.value,s=c&&a;return(0,t.jsx)("button",{onClick:()=>{var a;return a=e.value,void(!c&&(i(a),n(()=>{console.log("Role selected:",a),setTimeout(()=>{alert("Rol seleccionado: ".concat(a,". En producci\xf3n redirigir\xedas a: ").concat({patient:"/patients",doctor:"/doctors",company_admin:"/companies",platform_admin:"/admin"}[a]))},1e3)})))},disabled:c,className:"\n                w-full p-4 rounded-xl border-2 transition-all duration-200 text-left\n                ".concat(a?"border-blue-500 bg-blue-50":e.color,"\n                ").concat(c?"opacity-50 cursor-not-allowed":"cursor-pointer","\n                disabled:opacity-50 disabled:cursor-not-allowed\n              "),children:(0,t.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,t.jsx)("div",{className:"text-2xl",children:e.icon}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:e.label}),s&&(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]})]})},e.value)})}),c&&(0,t.jsx)("div",{className:"text-center py-4",children:(0,t.jsx)("p",{className:"text-sm text-blue-600 font-medium",children:"Configurando tu cuenta..."})}),(0,t.jsx)("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:(0,t.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,t.jsx)("strong",{children:"Nota:"})," Podr\xe1s cambiar tu rol m\xe1s tarde desde la configuraci\xf3n de tu cuenta."]})})]})}function l(){let[e,a]=(0,s.useState)(null),[r,o]=(0,s.useState)(!0),[l,d]=(0,s.useState)(null),u=(0,i.useRouter)(),m=(0,c.UU)();return((0,s.useEffect)(()=>{(async()=>{try{var e,r;if(!m){d("Error de configuraci\xf3n"),o(!1);return}let{data:{user:t},error:s}=await m.auth.getUser();if(s||!t)return void u.push("/auth/login");let i=null==(e=t.user_metadata)?void 0:e.role,c=null==(r=t.user_metadata)?void 0:r.pendingRoleSelection;if(i&&!c)return void u.push("/");a(t),o(!1)}catch(e){console.error("Error checking user:",e),d("Error al verificar usuario"),o(!1)}})()},[u,m]),r)?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-autamedica-negro via-autamedica-secondary to-autamedica-negro flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"bg-autamedica-negro/50 backdrop-blur-lg rounded-2xl p-8 border border-autamedica-secondary/30 text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-autamedica-primary mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-autamedica-blanco",children:"Verificando usuario..."})]})}):l?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-autamedica-negro via-autamedica-secondary to-autamedica-negro flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"bg-autamedica-negro/50 backdrop-blur-lg rounded-2xl p-8 border border-autamedica-secondary/30 text-center",children:[(0,t.jsx)("p",{className:"text-red-400 mb-4",children:l}),(0,t.jsx)("button",{onClick:()=>u.push("/auth/login"),className:"bg-autamedica-primary text-white px-4 py-2 rounded-lg hover:bg-autamedica-primary-dark transition-colors",children:"Ir al Login"})]})}):e?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-autamedica-negro via-autamedica-secondary to-autamedica-negro flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"max-w-lg w-full bg-autamedica-negro/50 backdrop-blur-lg rounded-2xl shadow-xl p-8 border border-autamedica-secondary/30",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-autamedica-blanco mb-2",children:"\xa1Bienvenido a AutaMedica!"}),(0,t.jsx)("p",{className:"text-autamedica-text-light",children:"Para comenzar, por favor selecciona tu rol en la plataforma"})]}),(0,t.jsx)(n,{user:e}),(0,t.jsx)("div",{className:"mt-8 pt-6 border-t border-autamedica-secondary/30",children:(0,t.jsxs)("p",{className:"text-sm text-autamedica-text-light text-center",children:["\xbfNecesitas ayuda?"," ",(0,t.jsx)("a",{href:"/support",className:"text-autamedica-primary hover:text-white font-medium",children:"Contacta soporte"})]})})]})}):null}}},e=>{e.O(0,[66,554,829,358],()=>e(e.s=5637)),_N_E=e.O()}]);