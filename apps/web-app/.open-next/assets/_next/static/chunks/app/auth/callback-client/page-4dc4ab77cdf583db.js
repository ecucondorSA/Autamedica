(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[231],{3842:(e,a,t)=>{"use strict";t.d(a,{UU:()=>i});var r=t(3427);function i(){let e="https://gtyvdircfhmdjiaelqkg.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd0eXZkaXJjZmhtZGppYWVscWtnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2Njc4NTUsImV4cCI6MjA3MjI0Mzg1NX0.DeEm08k7QOrKObWaz8AUaOB5N6Z2QZhZHFaUf2siALA";return e&&a?(0,r.createBrowserClient)(e,a):(console.error("Supabase configuration error: Invalid URL or key"),(0,r.createBrowserClient)("https://gtyvdircfhmdjiaelqkg.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd0eXZkaXJjZmhtZGppYWVscWtnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYyOTI3OTAsImV4cCI6MjA3MTg2ODc5MH0.7UFMVZsWTWOAynnhzkG76I_lhVCYtd_RmTt9EH3wJD4"))}t(4444)},8911:(e,a,t)=>{Promise.resolve().then(t.bind(t,9996))},9996:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>n});var r=t(3919),i=t(1111),s=t(4336),c=t(3842);function o(){let e=(0,s.useRouter)(),a=(0,s.useSearchParams)(),[t,o]=(0,i.useState)("Procesando autenticaci\xf3n..."),[n,d]=(0,i.useState)(null);return(0,i.useEffect)(()=>{(async()=>{let t=a.get("code");if(!t){d("No se encontr\xf3 c\xf3digo de autorizaci\xf3n"),setTimeout(()=>e.push("/auth/login?error=no_code"),2e3);return}let r=(0,c.UU)();if(!r){d("Error de configuraci\xf3n de Supabase"),setTimeout(()=>e.push("/auth/login?error=config_error"),2e3);return}try{o("Intercambiando c\xf3digo por sesi\xf3n...");let{data:a,error:s}=await r.auth.exchangeCodeForSession(t);if(s){console.error("Auth callback error:",s),d("Error al procesar autenticaci\xf3n: "+s.message),setTimeout(()=>e.push("/auth/login?error=auth_callback_error"),2e3);return}if(a.user){var i;let t=null==(i=a.user.user_metadata)?void 0:i.role;if(console.log("Auth callback - User:",a.user.email,"Role:",t),o("Redirigiendo seg\xfan rol..."),t){let a="localhost"===window.location.hostname?({patient:"http://localhost:3002",doctor:"http://localhost:3001",company_admin:"http://localhost:3003",company:"http://localhost:3003",platform_admin:"/admin",admin:"/admin"})[t]||"/":({patient:"https://autamedica-patients.pages.dev",doctor:"https://autamedica-doctors.pages.dev",company_admin:"https://autamedica-companies.pages.dev",company:"https://autamedica-companies.pages.dev",platform_admin:"/admin",admin:"/admin"})[t]||"/";if(a){console.log("Redirecting to:",a),o("Redirigiendo a ".concat(t,"...")),setTimeout(()=>{a.startsWith("/")?e.push(a):window.location.href=a},1e3);return}}console.log("No role found, redirecting to role selection"),o("Configurando perfil..."),setTimeout(()=>e.push("/auth/select-role"),1e3)}}catch(a){console.error("Auth callback exception:",a),d("Error inesperado durante autenticaci\xf3n"),setTimeout(()=>e.push("/auth/login?error=callback_exception"),2e3)}})()},[a,e]),(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-autamedica-negro via-autamedica-secondary to-autamedica-negro flex items-center justify-center p-4",children:(0,r.jsx)("div",{className:"w-full max-w-md",children:(0,r.jsxs)("div",{className:"bg-autamedica-negro/50 backdrop-blur-lg rounded-2xl p-8 border border-autamedica-secondary/30 text-center",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-autamedica-primary mx-auto mb-4"}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-autamedica-blanco mb-2",children:"AutaMedica"}),(0,r.jsx)("p",{className:"text-white text-sm",children:"Desarrollado por E.M Medicina - UBA"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("p",{className:"text-autamedica-blanco",children:t}),n&&(0,r.jsxs)("div",{className:"bg-red-900/20 border border-red-700/50 rounded-lg p-4",children:[(0,r.jsx)("p",{className:"text-red-400 text-sm",children:n}),(0,r.jsx)("p",{className:"text-red-300 text-xs mt-2",children:"Redirigiendo al login..."})]})]})]})})})}function n(){return(0,r.jsx)(i.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-autamedica-negro via-autamedica-secondary to-autamedica-negro flex items-center justify-center p-4",children:(0,r.jsx)("div",{className:"w-full max-w-md",children:(0,r.jsxs)("div",{className:"bg-autamedica-negro/50 backdrop-blur-lg rounded-2xl p-8 border border-autamedica-secondary/30 text-center",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-autamedica-primary mx-auto mb-4"}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-autamedica-blanco mb-2",children:"AutaMedica"}),(0,r.jsx)("p",{className:"text-white text-sm",children:"Desarrollado por E.M Medicina - UBA"})]}),(0,r.jsx)("p",{className:"text-autamedica-blanco",children:"Cargando..."})]})})}),children:(0,r.jsx)(o,{})})}}},e=>{e.O(0,[66,554,829,358],()=>e(e.s=8911)),_N_E=e.O()}]);