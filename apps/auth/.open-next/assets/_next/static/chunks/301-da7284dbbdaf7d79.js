"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[301],{7301:(e,t,n)=>{n.d(t,{OZ:()=>y,Ob:()=>E,PA:()=>T,LP:()=>N,eD:()=>U,yz:()=>_,Sj:()=>A,vF:()=>f});var a,i,o,r=n(5532),s=n(9679);let c={ERROR:"error",WARN:"warn",INFO:"info",DEBUG:"debug"},l=[c.ERROR,c.WARN,c.INFO,c.DEBUG],d=void 0!==s?s:void 0,u=null==d||null==(a=d.env)?void 0:a.LOG_LEVEL,m=null!=(o=null==d||null==(i=d.env)?void 0:i.NODE_ENV)?o:"development",h=function(){let e=null==u?void 0:u.toLowerCase();if(e){let t=l.find(t=>t===e);if(t)return t}return"production"===m?c.INFO:c.DEBUG}();class p{error(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];this.log(c.ERROR,e,n)}warn(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];this.log(c.WARN,e,n)}info(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];this.log(c.INFO,e,n)}debug(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];this.log(c.DEBUG,e,n)}child(e){let t={...this.context,...e};return new p(this.instance,t,this.minLevel)}log(e,t,n){if(!this.shouldLog(e))return;let a=this.prepareParts(t,n);switch(e){case c.ERROR:this.instance.error(...a);break;case c.WARN:this.instance.warn(...a);break;case c.DEBUG:this.instance.debug(...a);break;default:this.instance.info(...a)}}shouldLog(e){return l.indexOf(e)<=this.thresholdIndex}prepareParts(e,t){let n=[e],[a,...i]=t,o=null,r=[];if("object"!=typeof a||null===a||Array.isArray(a)?void 0!==a&&r.push(a):o={...a},r.push(...i),Object.keys(this.context).length>0&&(o={...null!=o?o:{},context:{...this.context}}),o&&n.push(o),r.length>0){let e=r.map(e=>"symbol"==typeof e?e.toString():e);n.push(...e)}return n}constructor(e,t={},n=h){this.instance=e,this.context=t;let a=l.includes(n)?n:h;this.minLevel=a,this.thresholdIndex=l.indexOf(a)}}let f=new p(r.Ay);var v=n(9679);let g=void 0!==v?v:null;function _(){var e;let t=null==g||null==(e=g.env)?void 0:e.NODE_ENV;return"development"===t||void 0===t}function E(e){var t,n;if(e.startsWith("NEXT_PUBLIC_"))switch(e){case"NEXT_PUBLIC_SUPABASE_URL":return"https://ewpsepaieakqbywxnidu.supabase.co";case"NEXT_PUBLIC_SUPABASE_ANON_KEY":return"sb_publishable_Koq4PaA5lOihpU6m4UoiqA_pdi0rZsk";case"NEXT_PUBLIC_API_URL":if(!v.env.NEXT_PUBLIC_API_URL)throw Error("Missing required environment variable: ".concat(e));return v.env.NEXT_PUBLIC_API_URL;case"NEXT_PUBLIC_APP_URL":if(!v.env.NEXT_PUBLIC_APP_URL)throw Error("Missing required environment variable: ".concat(e));return v.env.NEXT_PUBLIC_APP_URL;case"NEXT_PUBLIC_SITE_URL":if(!v.env.NEXT_PUBLIC_SITE_URL)throw Error("Missing required environment variable: ".concat(e));return v.env.NEXT_PUBLIC_SITE_URL;default:let a=null==g||null==(n=g.env)?void 0:n[e];if(!a)throw Error("Missing required environment variable: ".concat(e));return a}let i=null==g||null==(t=g.env)?void 0:t[e];if(!i)throw Error("Missing required environment variable: ".concat(e));return i}let C=void 0!==n(9679)?{patient:"https://patients.autamedica.com",doctor:"https://doctors.autamedica.com",company_admin:"https://companies.autamedica.com",organization_admin:"https://admin.autamedica.com",platform_admin:"https://www.autamedica.com"}:{patient:"http://localhost:3002",doctor:"http://localhost:3001",company_admin:"http://localhost:3003",organization_admin:"http://localhost:3004",platform_admin:"http://localhost:3000"},R={patient:"/",doctor:"/",company_admin:"/",organization_admin:"/",platform_admin:"/"};function U(e,t){let n=C[e];if(!n)throw Error("No base URL configured for role: ".concat(e));let a=t||R[e];if(!a)throw Error("No home path configured for role: ".concat(e));return new URL(a,n).toString()}n(9679),n(9679);var b=n(9679);class w{static async getUserMediaWithRetry(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={...this.DEFAULT_RETRY_CONFIG,...e};for(let e of this.FALLBACK_CONSTRAINTS)try{var n,a;f.info("\uD83C\uDFA5 Intentando getUserMedia con:",e);let i=await this.attemptGetUserMedia(e,t);return f.info("✅ getUserMedia exitoso:",{video:i.getVideoTracks().length>0,audio:i.getAudioTracks().length>0,videoTrack:null==(n=i.getVideoTracks()[0])?void 0:n.getSettings(),audioTrack:null==(a=i.getAudioTracks()[0])?void 0:a.getSettings()}),i}catch(t){f.warn("⚠️ getUserMedia fall\xf3 con constraints:",e,t);continue}throw Error("No se pudo acceder a c\xe1mara/micr\xf3fono con ninguna configuraci\xf3n")}static async attemptGetUserMedia(e,t){let n=null;for(let a=0;a<=t.maxRetries;a++)try{return await navigator.mediaDevices.getUserMedia(e)}catch(e){if(n=e,e instanceof DOMException&&("NotAllowedError"===e.name||"NotFoundError"===e.name))throw e;if(a<t.maxRetries){let e=Math.min(t.initialDelay*Math.pow(t.backoffMultiplier,a),t.maxDelay);f.info("\uD83D\uDD04 Reintentando getUserMedia en ".concat(e,"ms (intento ").concat(a+1,"/").concat(t.maxRetries,")")),await this.delay(e)}}throw n||Error("getUserMedia fall\xf3 despu\xe9s de todos los reintentos")}static setupICEConnectionMonitoring(e,t){let n=null,a=!1,i=()=>{let i=e.iceConnectionState;switch(f.info("\uD83D\uDD17 ICE Connection State:",i),n&&(clearTimeout(n),n=null),i){case"connected":case"completed":f.info("✅ Conexi\xf3n WebRTC establecida"),a=!1;break;case"disconnected":f.warn("⚠️ Conexi\xf3n WebRTC desconectada, esperando reconexi\xf3n..."),n=setTimeout(()=>{"disconnected"!==e.iceConnectionState||a||(f.info("\uD83D\uDD04 Iniciando reconexi\xf3n WebRTC..."),a=!0,null==t||t())},5e3);break;case"failed":f.error("❌ Conexi\xf3n WebRTC fall\xf3"),a||(a=!0,null==t||t());break;case"closed":f.info("\uD83D\uDD10 Conexi\xf3n WebRTC cerrada")}};return e.addEventListener("iceconnectionstatechange",i),()=>{e.removeEventListener("iceconnectionstatechange",i),n&&clearTimeout(n)}}static async getConnectionStats(e){let t=await e.getStats(),n=0,a=0,i=0,o=0;return t.forEach(e=>{"inbound-rtp"===e.type&&(n+=e.bytesReceived||0,i+=e.packetsReceived||0),"outbound-rtp"===e.type&&(a+=e.bytesSent||0,o+=e.packetsSent||0)}),{bytesReceived:n,bytesSent:a,packetsReceived:i,packetsSent:o,connectionState:e.connectionState,iceConnectionState:e.iceConnectionState,timestamp:Date.now()}}static async testICEServers(e){try{let t=new RTCPeerConnection({iceServers:e});return t.createDataChannel("test"),await t.createOffer(),new Promise(e=>{let n=!1;t.onicecandidate=a=>{a.candidate?(f.info("\uD83E\uDDCA ICE Candidate encontrado:",a.candidate.candidate),n=!0):(f.info("\uD83E\uDDCA ICE gathering completado, v\xe1lido:",n),t.close(),e(n))},setTimeout(()=>{f.info("⏰ Timeout en test ICE servers"),t.close(),e(!1)},1e4)})}catch(e){return f.error("❌ Error testing ICE servers:",e),!1}}static createICEServers(){let e=[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302"]}],t=b.env.NEXT_PUBLIC_TURN_URLS,n=b.env.NEXT_PUBLIC_TURN_USERNAME,a=b.env.NEXT_PUBLIC_TURN_CREDENTIAL;return t&&n&&a&&e.push({urls:t.split(","),username:n,credential:a}),e}static diagnoseGetUserMediaError(e){if(e instanceof DOMException)switch(e.name){case"NotAllowedError":return"Permisos de c\xe1mara/micr\xf3fono denegados. Por favor, habilita los permisos en tu navegador.";case"NotFoundError":return"No se encontr\xf3 c\xe1mara o micr\xf3fono. Verifica que los dispositivos est\xe9n conectados.";case"NotReadableError":return"C\xe1mara o micr\xf3fono en uso por otra aplicaci\xf3n. Cierra otras apps que puedan estar us\xe1ndolos.";case"OverconstrainedError":return"La configuraci\xf3n solicitada no es compatible con tu dispositivo.";case"NotSupportedError":return"Tu navegador no soporta acceso a c\xe1mara/micr\xf3fono.";case"AbortError":return"Acceso a c\xe1mara/micr\xf3fono fue cancelado.";default:return"Error de c\xe1mara/micr\xf3fono: ".concat(e.message)}return"Error desconocido: ".concat(e.message)}static async diagnose(){f.info("\uD83D\uDD0D Starting WebRTC diagnostics...");let e=await navigator.mediaDevices.enumerateDevices();f.info("\uD83D\uDCF1 Available devices:",e.map(e=>({kind:e.kind,label:e.label||"Unknown device",deviceId:e.deviceId.substring(0,8)+"..."})));let t={camera:await this.checkPermission("camera"),microphone:await this.checkPermission("microphone")};return f.info("\uD83D\uDD10 Permissions:",t),{devices:e,permissions:t,capabilities:{video:null,audio:null}}}static async checkPermission(e){try{return(await navigator.permissions.query({name:e})).state}catch(e){return"prompt"}}static delay(e){return new Promise(t=>setTimeout(t,e))}}function N(e){return({doctor:"M\xe9dico",patient:"Paciente",company_admin:"Administrador de Empresa",organization_admin:"Administrador de Organizaci\xf3n",platform_admin:"Administrador de Plataforma"})[e]}function T(e){return({doctor:"Consulta pacientes, gestiona historias cl\xednicas y realiza teleconsultas",patient:"Accede a tu historial m\xe9dico, agenda citas y consulta con m\xe9dicos",company_admin:"Administra empleados de tu empresa y gestiona planes de salud corporativos",organization_admin:"Gestiona m\xfaltiples organizaciones y supervisa operaciones",platform_admin:"Control total de la plataforma y todas sus funcionalidades"})[e]}function A(e){return["doctor","patient","company_admin","organization_admin","platform_admin"].includes(e)}w.DEFAULT_RETRY_CONFIG={maxRetries:3,initialDelay:1e3,backoffMultiplier:2,maxDelay:1e4},w.FALLBACK_CONSTRAINTS=[{video:{width:{ideal:1280},height:{ideal:720},frameRate:{ideal:30},facingMode:"user"},audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}},{video:{width:{ideal:640},height:{ideal:480},frameRate:{ideal:24}},audio:{echoCancellation:!0}},{video:{width:{max:320},height:{max:240}},audio:!0},{video:!1,audio:!0}];let y=["doctor","patient","company_admin","organization_admin","platform_admin"];(0,n(9554).UU)("https://ewpsepaieakqbywxnidu.supabase.co","sb_publishable_Koq4PaA5lOihpU6m4UoiqA_pdi0rZsk")}}]);