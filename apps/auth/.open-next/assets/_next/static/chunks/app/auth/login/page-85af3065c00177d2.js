(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[859],{1184:(e,r,t)=>{"use strict";t.d(r,{U:()=>n});var s=t(4296),a=t(1899),o=t.n(a);function n(e){let{size:r="md"}=e,{dimension:t,containerClass:a,borderClass:n}={sm:{dimension:64,containerClass:"w-16 h-16",borderClass:"border-2"},md:{dimension:96,containerClass:"w-24 h-24",borderClass:"border-[3px]"},lg:{dimension:128,containerClass:"w-32 h-32",borderClass:"border-4"}}[r];return(0,s.jsx)("div",{className:"\n      ".concat(a,"\n      ").concat(n,"\n      mx-auto\n      mb-6\n      rounded-full\n      border-[var(--au-border)]\n      bg-[var(--au-surface)]\n      p-2\n      shadow-lg\n      flex\n      items-center\n      justify-center\n      overflow-hidden\n    "),children:(0,s.jsx)(o(),{src:"/autamedica-logo.png",alt:"AUTAMEDICA Logo",width:t,height:t,className:"object-contain rounded-full",priority:!0})})}},1899:(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),!function(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}(r,{default:function(){return c},getImageProps:function(){return i}});let s=t(6785),a=t(7853),o=t(461),n=s._(t(2119));function i(e){let{props:r}=(0,a.getImgProps)(e,{defaultLoader:n.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[e,t]of Object.entries(r))void 0===t&&delete r[e];return{props:r}}let c=o.Image},6035:(e,r,t)=>{Promise.resolve().then(t.bind(t,9511))},9511:(e,r,t)=>{"use strict";t.d(r,{LoginForm:()=>m});var s=t(4296),a=t(3204),o=t(4209),n=t(7301),i=t(1184),c=t(111),l=t(7364);class u{async signIn(e){let{email:r,password:t,role:s,returnTo:a}=e;try{let{data:e,error:i}=await this.client.auth.signInWithPassword({email:r.trim().toLowerCase(),password:t});if(i){var o;return{success:!1,error:{message:"Invalid login credentials"===i.message?"Email o contrase\xf1a incorrectos":i.message,code:null==(o=i.status)?void 0:o.toString(),details:i}}}let c=a||(s?(0,n.eD)(s):"/auth/select-role");if("localhost"===window.location.hostname&&e.session){let r=new URL(c,window.location.origin);r.searchParams.set("access_token",e.session.access_token),r.searchParams.set("refresh_token",e.session.refresh_token),c=r.toString()}return{success:!0,data:{redirectUrl:c}}}catch(e){return n.vF.error("AuthService.signIn error:",e),{success:!1,error:{message:"Error de conexi\xf3n",details:e}}}}async signUp(e){let{email:r,password:t,role:s,metadata:a={},returnTo:o}=e;try{let{data:e,error:c}=await this.client.auth.signUp({email:r.trim().toLowerCase(),password:t,options:{data:{...a,role:s},emailRedirectTo:o?"".concat(window.location.origin,"/auth/callback?returnTo=").concat(encodeURIComponent(o)):"".concat(window.location.origin,"/auth/callback")}});if(c){var i;return{success:!1,error:{message:c.message.includes("already registered")?"Ya existe una cuenta con este email":c.message,code:null==(i=c.status)?void 0:i.toString(),details:c}}}let l=o||(s?(0,n.eD)(s):"/auth/select-role");return{success:!0,data:{redirectUrl:l}}}catch(e){return n.vF.error("AuthService.signUp error:",e),{success:!1,error:{message:"Error al crear cuenta",details:e}}}}async signInWithOAuth(e){let{provider:r,role:t,returnTo:s}=e;try{let e=new URL("".concat(window.location.origin,"/auth/callback"));t&&e.searchParams.set("role",t),s&&e.searchParams.set("returnTo",s);let{error:o}=await this.client.auth.signInWithOAuth({provider:r,options:{redirectTo:e.toString(),queryParams:{access_type:"offline",prompt:"consent"}}});if(o){var a;return{success:!1,error:{message:"Error con ".concat(r),code:null==(a=o.status)?void 0:a.toString(),details:o}}}return{success:!0}}catch(e){return n.vF.error("AuthService.signInWithOAuth error:",e),{success:!1,error:{message:"Error de autenticaci\xf3n",details:e}}}}async signOut(){try{let{error:r}=await this.client.auth.signOut();if(r){var e;return{success:!1,error:{message:"Error al cerrar sesi\xf3n",code:null==(e=r.status)?void 0:e.toString(),details:r}}}return{success:!0}}catch(e){return n.vF.error("AuthService.signOut error:",e),{success:!1,error:{message:"Error de conexi\xf3n",details:e}}}}async resetPassword(e){try{let{error:t}=await this.client.auth.resetPasswordForEmail(e.trim().toLowerCase(),{redirectTo:"".concat(window.location.origin,"/auth/reset-password")});if(t){var r;return{success:!1,error:{message:"Error al enviar email",code:null==(r=t.status)?void 0:r.toString(),details:t}}}return{success:!0}}catch(e){return n.vF.error("AuthService.resetPassword error:",e),{success:!1,error:{message:"Error de conexi\xf3n",details:e}}}}async refreshSession(){try{let{error:r}=await this.client.auth.refreshSession();if(r){var e;return{success:!1,error:{message:"Error al actualizar sesi\xf3n",code:null==(e=r.status)?void 0:e.toString(),details:r}}}return{success:!0}}catch(e){return n.vF.error("AuthService.refreshSession error:",e),{success:!1,error:{message:"Error de conexi\xf3n",details:e}}}}async getSession(){try{let{data:e,error:r}=await this.client.auth.getSession();if(r)return{success:!1,error:{message:"Error al obtener sesi\xf3n",details:r}};return{success:!0,data:e.session}}catch(e){return n.vF.error("AuthService.getSession error:",e),{success:!1,error:{message:"Error de conexi\xf3n",details:e}}}}async getUser(){try{let{data:e,error:r}=await this.client.auth.getUser();if(r)return{success:!1,error:{message:"Error al obtener usuario",details:r}};return{success:!0,data:e.user}}catch(e){return n.vF.error("AuthService.getUser error:",e),{success:!1,error:{message:"Error de conexi\xf3n",details:e}}}}constructor(e){this.client=null!=e?e:(0,l.UZ)()}}let d=null;function m(){let[e,r]=(0,a.useState)(""),[t,l]=(0,a.useState)(""),[m,h]=(0,a.useState)(null),[v,x]=(0,a.useState)(null),g=(0,o.useRouter)(),{loading:f,error:b,isAuthenticated:p}=(0,c.Z2)(),[w,y]=(0,a.useState)(null),[j,N]=(0,a.useState)(!1),S=(0,a.useMemo)(()=>(d||(d=new u),d),[]);(0,a.useEffect)(()=>{let e=new URLSearchParams(window.location.search),r=e.get("role"),t=e.get("returnTo");h(r),x(t),r&&(0,n.Sj)(r)||g.push("/auth/select-role")},[g]),(0,a.useEffect)(()=>{if(p&&m){let e=v||"/auth/callback?role=".concat(m);g.push(e)}},[p,m,v,g]);let C=async r=>{var s,a;r.preventDefault(),N(!0),y(null);let o=await S.signIn({email:e,password:t,role:m||void 0,returnTo:v||void 0});if(!o.success){y((null==(a=o.error)?void 0:a.message)||"Error al iniciar sesi\xf3n"),N(!1);return}(null==(s=o.data)?void 0:s.redirectUrl)&&(window.location.href=o.data.redirectUrl)},k=async()=>{N(!0),y(null);let e=await S.signInWithOAuth({provider:"google",role:m||void 0,returnTo:v||void 0});if(!e.success){var r;y((null==(r=e.error)?void 0:r.message)||"Error con Google"),N(!1)}};if(!m||!(0,n.Sj)(m))return null;let E=(0,n.LP)(m),A=w||(null==b?void 0:b.message),I=f||j;return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center p-6 bg-[var(--au-bg)]",children:(0,s.jsx)("div",{className:"w-full max-w-md",children:(0,s.jsxs)("div",{className:"bg-[var(--au-surface)] border-2 border-[var(--au-border)] rounded-2xl shadow-2xl p-8",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)(i.U,{size:"md"}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-[var(--au-text-primary)] mb-2",children:"Bienvenido de vuelta"}),(0,s.jsxs)("div",{className:"inline-flex items-center px-4 py-2 bg-[var(--au-hover)] rounded-full border-2 border-[var(--au-border)] mb-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2 animate-pulse"}),(0,s.jsxs)("span",{className:"text-sm font-medium text-[var(--au-text-secondary)]",children:["Acceso como ",E]})]}),(0,s.jsxs)("p",{className:"text-[var(--au-text-secondary)] text-sm",children:["\xbfNo es tu rol?"," ",(0,s.jsx)("a",{href:"/auth/select-role",className:"text-[var(--au-accent)] hover:text-[var(--au-text-primary)] font-medium transition-colors",children:"Cambiar aqu\xed"})]})]}),A&&(0,s.jsx)("div",{className:"mb-6 bg-red-500/10 border-2 border-red-500/30 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{className:"w-5 h-5 text-red-400 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,s.jsx)("p",{className:"text-sm text-red-300",children:A})]})}),(0,s.jsxs)("button",{onClick:k,disabled:I,className:"w-full flex items-center justify-center gap-3 px-6 py-3 bg-[var(--au-hover)] hover:bg-[var(--au-hover-border)] border-2 border-[var(--au-border)] hover:border-[var(--au-accent)] rounded-xl text-[var(--au-text-primary)] font-medium transition-all duration-200 mb-6 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsxs)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[(0,s.jsx)("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,s.jsx)("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,s.jsx)("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,s.jsx)("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continuar con Google"]}),(0,s.jsxs)("div",{className:"relative mb-6",children:[(0,s.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,s.jsx)("div",{className:"w-full h-px bg-gradient-to-r from-transparent via-[var(--au-border)] to-transparent"})}),(0,s.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,s.jsx)("span",{className:"px-4 py-1 text-[var(--au-text-secondary)] bg-[var(--au-surface)] rounded-full border-2 border-[var(--au-border)]",children:"o contin\xfaa con email"})})]}),(0,s.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-[var(--au-text-secondary)] mb-2",children:"Correo electr\xf3nico"}),(0,s.jsx)("input",{id:"email",type:"email",value:e,onChange:e=>r(e.target.value),required:!0,disabled:I,className:"w-full px-4 py-3 bg-[var(--au-hover)] border-2 border-[var(--au-border)] rounded-xl text-[var(--au-text-primary)] placeholder:text-[var(--au-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--au-accent)] focus:border-transparent transition-all disabled:opacity-50",placeholder:"tu@email.com"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-[var(--au-text-secondary)] mb-2",children:"Contrase\xf1a"}),(0,s.jsx)("input",{id:"password",type:"password",value:t,onChange:e=>l(e.target.value),required:!0,disabled:I,className:"w-full px-4 py-3 bg-[var(--au-hover)] border-2 border-[var(--au-border)] rounded-xl text-[var(--au-text-primary)] placeholder:text-[var(--au-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--au-accent)] focus:border-transparent transition-all disabled:opacity-50",placeholder:"••••••••"})]}),(0,s.jsx)("button",{type:"submit",disabled:I,className:"w-full px-6 py-3 bg-[var(--au-accent)] hover:bg-[var(--au-text-primary)] text-[var(--au-bg)] font-semibold rounded-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:I?"Iniciando sesi\xf3n...":"Iniciar Sesi\xf3n"})]}),(0,s.jsxs)("div",{className:"mt-8 pt-6 border-t-2 border-[var(--au-border)] text-center space-y-4",children:[(0,s.jsx)("p",{className:"text-sm text-[var(--au-text-tertiary)]",children:"\xbfNo tienes cuenta en AutaMedica?"}),(0,s.jsxs)("a",{href:"/auth/register?role=".concat(m),className:"inline-flex items-center justify-center w-full px-4 py-3 text-sm font-medium text-[var(--au-text-secondary)] hover:text-[var(--au-text-primary)] bg-[var(--au-hover)] hover:bg-[var(--au-hover-border)] border-2 border-[var(--au-border)] hover:border-[var(--au-accent)] rounded-xl transition-all duration-200",children:[(0,s.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),"Crear cuenta nueva"]}),(0,s.jsx)("div",{className:"flex justify-center space-x-6 text-xs text-[var(--au-text-tertiary)]",children:(0,s.jsx)("a",{href:"/auth/forgot-password",className:"hover:text-[var(--au-accent)] transition-colors",children:"\xbfOlvidaste tu contrase\xf1a?"})}),(0,s.jsxs)("div",{className:"flex items-center justify-center text-xs text-[var(--au-text-tertiary)] mt-4",children:[(0,s.jsx)("svg",{className:"w-4 h-4 mr-1.5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),"Conexi\xf3n segura y cifrada"]})]})]})})})}}},e=>{e.O(0,[67,461,927,301,111,356,702,358],()=>e(e.s=6035)),_N_E=e.O()}]);